# 平台初始化指南

## 概述

本文档说明如何初始化整个平台，清空所有测试数据，并确保所有功能正常工作。

## 已完成的修复

### 1. 数据库初始化脚本
- ✅ 创建了 `src/backend/init_db.py` 脚本用于清空所有测试数据
- ✅ 保留表结构，只清空数据

### 2. 后端API完善
- ✅ 创建用户统计API (`/api/users/stats`)
  - 待确认预约数
  - 已完成咨询数
  - 测评报告数
  - 收藏文章数

- ✅ 完善咨询师统计API (`/api/counselors/stats/mine`)
  - 待确认预约数
  - 今日咨询数
  - 总咨询次数
  - 好评率

- ✅ 咨询师时间管理API
  - `POST /api/counselors/schedules` - 设置可预约时段
  - `GET /api/counselors/schedules` - 获取时段设置

- ✅ 预约管理API完善
  - 支持咨询师和用户查看各自的预约列表
  - 支持咨询师确认/拒绝预约
  - 支持填写咨询小结

### 3. 前端组件修复
- ✅ `UserDashboard` - 使用真实API数据，不再硬编码
- ✅ `CounselorDashboard` - 使用真实API数据，添加时间管理功能
- ✅ 所有统计数据初始化为0（从数据库查询）

## 初始化步骤

### 1. 清空数据库

```bash
cd src/backend
python init_db.py
```

输入 `yes` 确认清空所有数据。

### 2. 重启后端服务

```bash
cd src/backend
python main.py
```

### 3. 验证前端功能

1. **用户注册登录**
   - 访问 `http://localhost:3000` 或 `http://localhost:3002`
   - 注册新用户
   - 登录后查看用户面板，所有统计数据应为0

2. **咨询师注册**
   - 以普通用户身份登录
   - 前往"个人中心"或相关页面
   - 申请成为咨询师（需要填写资质信息）
   - 等待管理员审核

3. **咨询师时间设置**
   - 以咨询师身份登录（需管理员审核通过）
   - 前往"个人设置"或"日程设置"
   - 设置每周可预约时段
   - 保存设置

4. **预约功能**
   - 用户搜索并选择咨询师
   - 创建预约请求
   - 咨询师确认或拒绝预约
   - 咨询完成后填写小结

## 功能说明

### 用户功能
- 注册登录（支持学号/手机号/邮箱）
- 查看统计数据（初始为0）
- 预约咨询（需咨询师审核通过后才能显示）
- 心理测评
- 健康科普
- 互助社区

### 咨询师功能
- 注册申请（需提交资质证明）
- 设置可预约时段（注册后才显示）
- 查看预约列表
- 确认/拒绝预约
- 填写咨询小结
- 查看统计数据

### 管理员功能
- 审核咨询师申请
- 查看平台统计数据
- 管理用户和内容

## 注意事项

1. **咨询师显示**：只有审核通过的咨询师才会在搜索列表中显示
2. **统计数据**：所有统计数据都从数据库实时查询，初始值为0
3. **预约功能**：用户只能看到已审核通过的咨询师
4. **时间设置**：咨询师需要先设置可预约时段，用户才能预约

## 常见问题

### Q: 为什么看不到咨询师？
A: 咨询师需要先注册并通过管理员审核，审核通过后才会在搜索列表中显示。

### Q: 为什么统计数据不是0？
A: 请运行 `init_db.py` 清空数据库，或检查是否已有数据。

### Q: 咨询师如何设置时间？
A: 咨询师登录后，在"个人设置"或"日程设置"标签页中设置每周可预约时段。

### Q: 用户如何预约？
A: 用户在"预约咨询"页面搜索咨询师，选择咨询师后选择可预约时段创建预约。

## 下一步

1. 实现心理咨询师注册UI（在用户中心添加申请入口）
2. 完善预约管理功能（用户取消预约、修改预约等）
3. 实现管理员审核功能
4. 添加更多测试数据（可选）





